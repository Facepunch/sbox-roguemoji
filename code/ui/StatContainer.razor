@using System;
@using Sandbox;
@using Sandbox.UI;

@inherits Panel;
@namespace Roguemoji

<style>
    .stat_container
    {
        height: 32px;
        border: 1px solid #151515;
        border-radius: 3px;
        margin: 2px;
        background-color: #050505;
        padding: 2px;
        justify-content: space-around;
    }

    .stat_icon
    {
        font-size: 18px;
        color: white;
        text-align: center;
        padding: 0px;
    }

    .stat_label
    {
        font-size: 18px;
        justify-content: flex-end;
        padding: 0 2px 0 0;
        min-width: 22px;
    }
</style>

<root class="stat_container">
    @if(Stat == null)
    {
        return;
    }

    <span class="stat_icon"> @($"{Thing.GetStatIcon(Stat.StatType)}") </span>
    <span class="stat_label" style="color: @(Stat.ClampedValue < 0 ? "#ff000055" : "#ffffff88");"> @($"{Stat.ClampedValue}") </span>
</root>

@code
{
    public Stat Stat { get; set; }

    protected override int BuildHash()
    {
        // todo
        return HashCode.Combine(Stat?.ClampedValue ?? 0);
    }

    protected override void OnAfterTreeRender(bool firstTime)
    {
        base.OnAfterTreeRender(firstTime);

        if (Stat == null)
            return;

        Tooltip = $"{Thing.GetStatName(Stat.StatType)}";
    }

    protected override Panel CreateTooltipPanel()
    {
        var panel = Hud.Instance.AddChild<StatTooltip>();
        panel.StatName = Tooltip;
        panel.StatType = Stat.StatType;
        panel.Stat = Stat;
        return panel;
    }
}