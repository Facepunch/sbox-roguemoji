@using Sandbox;
@using Sandbox.UI;

@inherits Panel;
@namespace Interfacer

<style>
    .drag_icon 
    {
        width: 40px;
        height: 40px;
        font-size: 29px;
        position: absolute;
        opacity: 0;
    }

    .fade_in
    {
        transition: opacity 0.4s ease;
    }
</style>

<root class="drag_icon @GetPlayerClass()">@Text</root>

@code
{
    public Thing Thing { get; set; }
    public string Text { get; set; }
    public int UpdateCount { get; set; }

    protected override void OnAfterTreeRender(bool firstTime)
    {
        base.OnAfterTreeRender(firstTime);

        if(firstTime)
        {
            //AddClass("fade_in");
            //Style.Opacity = 0.75f;
        }
    }

    public override void Tick()
    {
        base.Tick();

        var mousePos = Hud.Instance.GetMousePos();
        Style.Left = mousePos.x - 20f;
        Style.Top = mousePos.y - 20f;


        if(UpdateCount == 1)
        {
            AddClass("fade_in");
            Style.Opacity = 0.75f;
        }     

        UpdateCount++;
    }

    string GetPlayerClass()
    {
        return Thing.PlayerNum > 0 ? $"icon-player-{Thing.PlayerNum}" : "";
    }
}