@using Sandbox;
@using Sandbox.UI;
@using System;
@using System.Collections.Generic;

@inherits Panel;
@namespace Interfacer

<style>
    .log 
    {
        width:100%;
        height:810px;
        background-color: #5555ff11;
        margin-top: 40px;
        margin-right: 40px;
        flex-direction:column;
        align-content: flex-end;
        overflow: scroll;
        border: 2px solid #ffffff08;
        border-radius: 3px;
    }
</style>

<root class="log">
    @foreach((string message, int playerNum) in Messages)
    {
        <LogMessage @Text=@message @PlayerNum=@playerNum></LogMessage>
    }
</root>

@code
{
    public Queue<(string, int)> Messages { get; private set; } = new();

    public LogPanel()
    {
        PreferScrollToBottom = true;
    }

    public void WriteMessage(string text, int playerNum)
    {
        //if (Messages.Count() > 10)
        //    Messages.Dequeue();

        Messages.Enqueue((text, playerNum));
        TryScrollToBottom();
        StateHasChanged();
    }
}